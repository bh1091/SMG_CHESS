package org.sanjana.hw6.server;

import java.util.ArrayList;

import com.google.appengine.api.channel.ChannelMessage;
import com.google.appengine.api.channel.ChannelService;
import com.google.appengine.api.channel.ChannelServiceFactory;

public class GameManager 
{
	private static ArrayList<String> waitingList=new ArrayList<String>();
	private static int playerCount=waitingList.size();
	
	public static void match() 
	{
		if (playerCount%2 == 0) 
		{ 
//			MatchedPlayers.increamentmatchedPlayersId();
//			Window.alert("Player matching");
			MatchedPlayers.matchedPlayersId++;
			GameDetails newGame=new GameDetails();
			newGame.setPlayer1(new Integer(playerCount++).toString());
//			waitingList.add(new Integer(playerCount).toString());
//			newGame.setPlayer1()
			MatchedPlayers.setmatchedPlayers(newGame);
		}

		else
		{
			GameDetails oldGame=MatchedPlayers.getmatchedPlayers(MatchedPlayers.getmatchedPlayersId());
			oldGame.setPlayer2(new Integer(playerCount++).toString());
//			Window.alert("Player matched");
			ChannelService channelService = ChannelServiceFactory.getChannelService();
			channelService.sendMessage(new ChannelMessage(oldGame.getPlayer1(), new String("start")));
		}
	}

	public static int getPlayerCount(){
		//		return waitingList.size();
		return playerCount;
	}

	//	public static void addPlayer(String player){
	//		waitingList.add(player);
	//	}
	//
	//	public static GameDetails getmatchedPlayers(int matchedPlayersId) {
	//		if (matchedPlayers.containsKey(matchedPlayersId)) {
	//			return matchedPlayers.get(matchedPlayersId);
	//		}
	//		return null;
	//	}
	//
	//	public static void setmatchedPlayers(GameDetails matchedPlayersDetails){
	//		matchedPlayers.put(matchedPlayersId,matchedPlayersDetails);
	//	}
	//
	//	public static int getmatchedPlayersId(){
	//		return matchedPlayersId;
	//	}
	//
	//	public static void increamentmatchedPlayersId(){
	//		++matchedPlayersId;
	//	}
}
